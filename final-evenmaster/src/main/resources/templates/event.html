<!DOCTYPE html>
<html lang="az" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EventMaster — Tədbir</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/front/styles.css" />
    <style>
        body {
  background:
    radial-gradient(ellipse 1400px 800px at 15% -5%, rgba(108,92,231,0.35), transparent 50%),
    radial-gradient(ellipse 1200px 700px at 85% 10%, rgba(0,209,178,0.25), transparent 55%),
    radial-gradient(ellipse 1000px 600px at 50% 90%, rgba(108,92,231,0.15), transparent 50%),
    radial-gradient(ellipse 800px 500px at 0% 50%, rgba(0,209,178,0.12), transparent 45%),
    linear-gradient(135deg, rgba(11,12,16,0.95) 0%, rgba(11,12,16,1) 100%),
    var(--bg, #0b0c10);
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover;
  min-height: 100vh;
  position: relative;
}
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background:
    radial-gradient(circle 600px at 30% 20%, rgba(108,92,231,0.08), transparent 70%),
    radial-gradient(circle 500px at 70% 80%, rgba(0,209,178,0.06), transparent 70%);
  pointer-events: none;
  z-index: 0;
}
body > * {
  position: relative;
  z-index: 1;
}
    </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <a class="brand" href="/" aria-label="EventMaster ana səhifə">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 7h16M7 4v6m10-6v6M4 11h16v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>EventMaster</span>
      </a>
      <nav class="nav">
        <a href="/events">Tədbirlər</a>
        <a href="/login">Giriş</a>
        <a class="btn ghost" href="/register">Qeydiyyat</a>
      </nav>
    </div>
  </header>

  <main>
      <section class="hero" style="padding-top: 24px;">
          <div class="container event-detail">
              <div class="event-hero">
                  <img th:src="${event.image}" th:alt="${event.title}" />
                  <div class="event-hero-meta">
                      <h1 th:text="${event.title}">Tədbir adı</h1>
                      <p class="lead" th:text="${#temporals.format(event.dateLine, 'dd.MM.yyyy')} + ' • ' + ${event.location}">Tarix və məkan</p>
                  </div>
              </div>

              <div class="event-content">
                  <article class="card">
                      <h3 style="margin:0 0 8px;">Haqqında</h3>
                      <p th:text="${event.description}" style="color: var(--muted); margin: 0; line-height: 1.6;">Təsvir</p>
                  </article>

                  <aside class="card">
                      <h3 style="margin:0 0 8px;">Biletlər</h3>
                      <div class="ticket-options">
                          <label class="ticket-tier">
                              <input type="radio" name="tier" checked />
                              <div class="tier-body">
                                  <div class="tier-head">
                                      <span class="tier-name">Standart</span>
                                      <span class="tier-price" th:text="${event.priceStandard > 0 ? event.priceStandard + ' AZN' : 'Pulsuz'}">Qiymət</span>
                                  </div>
                                  <div class="tier-perks">Ümumi giriş</div>
                              </div>
                          </label>
                          <label class="ticket-tier">
                              <input type="radio" name="tier" />
                              <div class="tier-body">
                                  <div class="tier-head">
                                      <span class="tier-name">VIP</span>
                                      <span class="tier-price" th:text="${event.priceVip > 0 ? event.priceVip + ' AZN' : 'Pulsuz'}">Qiymət</span>
                                  </div>
                                  <div class="tier-perks">Ön sıralar • VIP lounge</div>
                              </div>
                          </label>
                      </div>

                      <div style="display:flex; align-items:center; justify-content: space-between; margin-top: 12px;">
                          <label style="display:flex; align-items:center; gap:8px;">
                              <span>Say:</span>
                              <input type="number" min="1" value="1" style="width:80px; background:#161822; border:1px solid var(--border); color:var(--text); padding:8px 10px; border-radius:10px;" />
                          </label>
                          <div style="display:flex; align-items:center; gap:10px;">
                              <span>Toplam:</span>
                              <strong>Hesablanacaq</strong>
                          </div>
                      </div>

                      <button class="btn primary" style="margin-top: 12px; width: 100%;">Bileti al</button>
                  </aside>
              </div>
              <section class="card" style="grid-column: 1 / -1; margin-top: 16px;">
                  <h3 style="margin:0 0 16px;">Rəylər</h3>

                  <div id="reviewsContainer" style="display: grid; gap: 16px; margin-bottom: 20px;">
                      <div th:each="r : ${reviewDTOs}" style="background: #161822; border: 1px solid var(--border); border-radius: 10px; padding: 12px;">
                          <p style="margin: 0 0 4px;">
                              <strong th:text="${r.userName}">İstifadəçi</strong> —
                              <span th:text="${r.rating}">5</span> ⭐

                              <a th:if="${r.editable or #authorization.expression('hasRole(''ADMIN'')')}"
                                 th:href="@{/reviews/edit(id=${r.id})}"
                                 style="color: #f5b50a; margin-left: 12px; font-weight: bold; text-decoration: none;">✎</a>

                          <form th:if="${r.editable or #authorization.expression('hasRole(''ADMIN'')')}"
                                th:action="@{/reviews/delete}" method="post" style="display:inline;">
                              <input type="hidden" name="id" th:value="${r.id}" />
                              <input type="hidden" name="eventId" th:value="${event.id}" />
                              <button type="submit"
                                      style="background:none; border:none; color:red; font-weight:bold; cursor:pointer; padding:0; margin-left:12px;">✖</button>
                          </form>
                          </p>
                          <p th:text="${r.comment}" style="margin: 0; color: var(--text); font-size: 14px;">Rəy mətni</p>
                      </div>
                  </div>

                  <div th:if="${not hasReviewed}">
                      <form th:action="@{/reviews/add}" method="post"
                            style="background: rgba(18,20,26,0.5); border: 1px solid var(--border); border-radius: 12px; padding: 16px; display: grid; gap: 12px;">
                          <h4 style="margin: 0 0 8px; font-size: 16px;">Rəy yazın</h4>

                          <input type="hidden" name="eventId" th:value="${event.id}" />

                          <div>
                              <label style="display: block; margin-bottom: 6px; color: var(--muted); font-size: 14px;">Qiymətləndirmə</label>
                              <div id="starRating" style="display: flex; gap: 4px; cursor: pointer;">
                                  <span class="star" data-rating="1" style="font-size: 24px; color: #444;">★</span>
                                  <span class="star" data-rating="2" style="font-size: 24px; color: #444;">★</span>
                                  <span class="star" data-rating="3" style="font-size: 24px; color: #444;">★</span>
                                  <span class="star" data-rating="4" style="font-size: 24px; color: #444;">★</span>
                                  <span class="star" data-rating="5" style="font-size: 24px; color: #444;">★</span>
                              </div>
                              <input type="hidden" name="rating" id="reviewRating" value="0" required />
                          </div>

                          <div>
                              <label style="display: block; margin-bottom: 6px; color: var(--muted); font-size: 14px;">Rəy</label>
                              <textarea name="comment" required rows="4"
                                        style="width: 100%; background: #161822; border: 1px solid var(--border); color: var(--text); padding: 10px 12px; border-radius: 10px; font-size: 14px; font-family: inherit; resize: vertical;"
                                        placeholder="Rəyinizi yazın..."></textarea>
                          </div>

                          <button type="submit" class="btn primary" style="width: 100%;">Rəy göndər</button>
                      </form>
                  </div>

                  <div th:if="${hasReviewed}">
                      <p style="color: #f5b50a; font-weight: bold;">Bu tədbirə artıq rəy yazmısınız.</p>
                  </div>
              </section>          </div>
      </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <p>© <span id="year"></span> EventMaster.</p>
      <nav class="footer-nav">
        <a href="/contact">Əlaqə</a>
      </nav>
    </div>
  </footer>


</body>
</html>
<script>
    const stars = document.querySelectorAll('.star');
    const ratingInput = document.getElementById('reviewRating');

    stars.forEach(star => {
      star.addEventListener('click', () => {
        const rating = star.getAttribute('data-rating');
        ratingInput.value = rating;
        stars.forEach(s => s.style.color = +s.getAttribute('data-rating') <= rating ? '#f5b50a' : '#444');
      });
    });
</script>

